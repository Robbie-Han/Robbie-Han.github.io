---
title: 老朋友-进程和线程
tags: 
- Node
- 进程
- 线程
toc: true
---
### 前言
  进程和线程应该是操作系统最基础的知识点，长时间不看有些遗忘，现总结一下。

### 进程和线程

课本中：进程是cpu资源分配的最小单位，线程是cpu调度的最小单位。

> 进程就是包括上下文切换的程序执行时间总和 = CPU加载上下文+CPU执行+CPU保存上下文

`进程的颗粒度太大，每次都要有上下的调入，保存，调出。`如果我们把进程比喻为一个运行在电脑上的软件，那么一个软件的执行不可能是一条逻辑执行的，必定有多个分支和多个程序段，就好比要实现程序A，实际分成 a，b，c等多个块组合而成。

那么这里具体的执行就可能变成：程序A得到CPU -> CPU加载上下文，开始执行程序A的a小段，然后执行A的b小段，然后再执行A的c小段，最后CPU保存A的上下文。这里a，b，c的执行是共享了A的上下文，CPU在执行的时候没有进行上下文切换的。这里的a，b，c就是线程，`也就是说线程是共享了进程的上下文环境，的更为细小的CPU时间段`。

<!--more-->
#### 互斥锁
  前面提出了线程可以共享进程的内存空间，但是有些共享内存一次性只允许一个线程使用，此时可以说线程是互斥的，而防止多个线程同时读写某一块内存区域的方法就叫做`互斥锁`。
#### 信号量
  某些进程的共享内存允许多个线程同时使用，但是允许的数量是有限的。如果已经达到容纳数量，其它线程只能等待。这保证了多个线程之间不会冲突。

  信号量就类似一个计数器，当信号量的值大于0时，线程可以使用共享资源，如果为0，则该资源目前不可用，线程进入睡眠状态，直至信号量值大于0，线程被唤醒

#### 进程和线程的区别：
- 进程是cpu资源分配的最小单位，线程是cpu调度的最小单位。
- 一个进程由一个或多个线程组成，线程是一个进程中代码的不同执行路线；
- 进程之间相互独立，但同一进程下的各个线程之间共享程序的内存空间(包括代码段、数据集、堆等)及一些进程级的资源(如打开文件和信号)。
- 调度和切换：线程上下文切换比进程上下文切换要快得多。

#### 多进程和多线程
多进程： 同一时间内可以有多个进程处于运行状态，例如网易云听歌和聊微信互不干扰。
多线程： 同一个进程中包含多个执行流，多个线程来执行程序中的不同的任务。

参考链接：https://www.zhihu.com/question/25532384/answer/81152571

阮一峰讲的也很形象：http://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html
